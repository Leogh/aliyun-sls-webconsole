extends ../layout

block stylesheets
  

block scripts
  

block content

  //- indicates the controller path

  input#controllerPath(type='hidden', value='consoles/log-analytics-controller')

  //- use 'controller as' to distiguish properties in $rootScope and the current controller scope

  div(ng-controller='LogAnalyticsController as vm')
    div.row
      div.col-md-12
        p
          a(href='', ng-click='vm.actions.toggleToolPanel()') {{ vm.showManagementTools ? 'Hide' : 'Show' }} Management Panel
        div(uib-collapse='!vm.showManagementTools')
          div.row
            div.col-sm-6
              div.panel.panel-info
                div.panel-heading Analytics Field
                div.panel-body
                  button.btn.btn-primary(ng-click='vm.actions.addOrUpdateFieldModal()') Add Analytics Field
                table.table.table-bordered
                  thead
                    tr
                      th Name
                      th Values
                      th Status
                      th Actions
                  tbody
                    tr(ng-repeat='field in vm.anaFields')
                      td {{ field.name }}
                      td {{ field.valueSet }}
                      td {{ field.status }}
                      td
                        button.btn.btn-primary.btn-sm(ng-click='vm.actions.addOrUpdateFieldModal(field)') Edit


            div.col-sm-6
              div.panel.panel-info
                div.panel-heading Compare Set
                div.panel-body
                  button.btn.btn-primary(ng-click='vm.actions.addOrUpdateCompareSetModal()') Add Analytics Compare Set
                table.table.table-bordered
                  thead
                    tr
                      th Name
                      th Compare Field
                      th Group Field
                      th Status
                      th Actions
                  tbody
                    tr(ng-repeat='set in vm.compareSets')
                      td {{ set.name }}
                      td {{ set.compareField.name }}
                      td {{ set.groupField != null ? set.groupField.name : "(None)" }}
                      td {{ set.status }}
                      td
                        button.btn.btn-primary.btn-sm(ng-click='vm.actions.addOrUpdateCompareSetModal(set)') Edit

    div.row.search-option-section
      div.col-md-12
        div.panel
          div.panel-body
            .form-inline
              //- From Date Options
              .form-group
                label From:&nbsp;
                .input-group
                  input.form-control(type='text', uib-datepicker-popup="yyyy-MM-dd", is-open="vm.fromIsOpen", ng-model='vm.options.from')
                  span.input-group-btn
                    button.btn.btn-default(ng-click='vm.fromIsOpen = true')
                      i.glyphicon.glyphicon-calendar
              //- Advanced time select
              .form-group(ng-show='vm.options.timeOptions.enabled')
                select.form-control(ng-model='vm.options.timeOptions.from.h',ng-options='hr for hr in vm.hours')
                label &nbsp;:&nbsp;
                select.form-control(ng-model='vm.options.timeOptions.from.m',ng-options='min for min in vm.minutes')
                label &nbsp;:&nbsp;
                select.form-control(ng-model='vm.options.timeOptions.from.s',ng-options='sec for sec in vm.seconds')
              br(ng-if='vm.options.timeOptions.enabled')
              //- To Date Options
              .form-group
                label
                  span(ng-if='vm.options.timeOptions.enabled') &nbsp;&nbsp;&nbsp;&nbsp;
                  | To:&nbsp;
                .input-group
                  input.form-control(type='text', uib-datepicker-popup="yyyy-MM-dd", is-open="vm.toIsOpen", ng-model='vm.options.to')
                  span.input-group-btn
                    button.btn.btn-default(ng-click='vm.options.toIsOpen = true')
                      i.glyphicon.glyphicon-calendar
              //- Advanced time select
              .form-group(ng-show='vm.options.timeOptions.enabled')
                select.form-control(ng-model='vm.options.timeOptions.to.h',ng-options='hr for hr in vm.hours')
                label &nbsp;:&nbsp;
                select.form-control(ng-model='vm.options.timeOptions.to.m',ng-options='min for min in vm.minutes')
                label &nbsp;:&nbsp;
                select.form-control(ng-model='vm.options.timeOptions.to.s',ng-options='sec for sec in vm.seconds')

              .form-group
                a(ng-click='vm.options.timeOptions.enabled = !vm.options.timeOptions.enabled', href='')
                  i.glyphicon.glyphicon-time(ng-show='!vm.options.timeOptions.enabled')
                  | &nbsp;{{ vm.options.timeOptions.enabled ? 'Hide' : 'Show' }} time options
              br
              .form-group
                label Compare Set:&nbsp;
                select.form-control(ng-options='set._id as set.name for set in vm.compareSets', ng-model='vm.options.compareSetId')
              .form-group
                button.btn.btn-primary(ng-click='vm.actions.analyze()') Analyze


    div.row.dashboard-section
      div.col-md-12


    include ../modals/analytics-field-modal

    include ../modals/analytics-compare-set-modal

